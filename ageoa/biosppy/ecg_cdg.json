{
  "nodes": [
    {
      "node_id": "ECGProcessor_root",
      "parent_id": null,
      "name": "ECGProcessor",
      "description": "Ingested pipeline from ECGProcessor",
      "concept_type": "custom",
      "inputs": [],
      "outputs": [],
      "status": "decomposed",
      "children": [
        "bandpass_filter",
        "r_peak_detection",
        "peak_correction",
        "template_extraction",
        "heart_rate_computation"
      ],
      "depth": 0,
      "type_signature": "",
      "matched_primitive": null,
      "is_optional": false,
      "is_opaque": false,
      "critic_notes": "",
      "decomposition_rationale": ""
    },
    {
      "node_id": "bandpass_filter",
      "parent_id": "ECGProcessor_root",
      "name": "Bandpass Filter",
      "description": "Apply Butterworth bandpass filtering (default 3-45 Hz) to suppress baseline wander and high-frequency noise",
      "concept_type": "signal_filter",
      "inputs": [
        {
          "name": "signal",
          "type_desc": "np.ndarray",
          "constraints": "1D raw ECG signal"
        }
      ],
      "outputs": [
        {
          "name": "filtered",
          "type_desc": "np.ndarray",
          "constraints": "bandpass-filtered ECG"
        }
      ],
      "status": "atomic",
      "children": [],
      "depth": 1,
      "type_signature": "(signal: np.ndarray, sampling_rate: float = 1000.0, lowcut: float = 3.0, highcut: float = 45.0, order: int = 4) -> np.ndarray",
      "matched_primitive": null,
      "is_optional": false,
      "is_opaque": false,
      "critic_notes": "",
      "decomposition_rationale": ""
    },
    {
      "node_id": "r_peak_detection",
      "parent_id": "ECGProcessor_root",
      "name": "R-Peak Detection",
      "description": "Detect R-peak sample indices from the filtered ECG signal",
      "concept_type": "custom",
      "inputs": [
        {
          "name": "filtered",
          "type_desc": "np.ndarray",
          "constraints": "filtered ECG signal"
        }
      ],
      "outputs": [
        {
          "name": "rpeaks",
          "type_desc": "np.ndarray",
          "constraints": "R-peak sample indices"
        }
      ],
      "status": "atomic",
      "children": [],
      "depth": 1,
      "type_signature": "(filtered: np.ndarray, sampling_rate: float = 1000.0) -> np.ndarray",
      "matched_primitive": null,
      "is_optional": false,
      "is_opaque": false,
      "critic_notes": "",
      "decomposition_rationale": ""
    },
    {
      "node_id": "peak_correction",
      "parent_id": "ECGProcessor_root",
      "name": "Peak Correction",
      "description": "Correct each detected peak to the nearest local maximum inside a bounded tolerance window",
      "concept_type": "custom",
      "inputs": [
        {
          "name": "filtered",
          "type_desc": "np.ndarray",
          "constraints": "filtered ECG signal"
        },
        {
          "name": "rpeaks",
          "type_desc": "np.ndarray",
          "constraints": "initial R-peak indices"
        }
      ],
      "outputs": [
        {
          "name": "rpeaks_corrected",
          "type_desc": "np.ndarray",
          "constraints": "corrected R-peak indices"
        }
      ],
      "status": "atomic",
      "children": [],
      "depth": 1,
      "type_signature": "(filtered: np.ndarray, rpeaks: np.ndarray, sampling_rate: float = 1000.0, tolerance_sec: float = 0.05) -> np.ndarray",
      "matched_primitive": null,
      "is_optional": false,
      "is_opaque": false,
      "critic_notes": "",
      "decomposition_rationale": ""
    },
    {
      "node_id": "template_extraction",
      "parent_id": "ECGProcessor_root",
      "name": "Template Extraction",
      "description": "Extract fixed-width beat templates around corrected R-peaks",
      "concept_type": "custom",
      "inputs": [
        {
          "name": "filtered",
          "type_desc": "np.ndarray",
          "constraints": "filtered ECG signal"
        },
        {
          "name": "rpeaks",
          "type_desc": "np.ndarray",
          "constraints": "corrected R-peak indices"
        }
      ],
      "outputs": [
        {
          "name": "templates",
          "type_desc": "np.ndarray",
          "constraints": "2D array of heartbeat templates"
        },
        {
          "name": "rpeaks_final",
          "type_desc": "np.ndarray",
          "constraints": "kept R-peak indices after boundary checks"
        }
      ],
      "status": "atomic",
      "children": [],
      "depth": 1,
      "type_signature": "(filtered: np.ndarray, rpeaks: np.ndarray, sampling_rate: float = 1000.0, before_sec: float = 0.2, after_sec: float = 0.4) -> tuple[np.ndarray, np.ndarray]",
      "matched_primitive": null,
      "is_optional": false,
      "is_opaque": false,
      "critic_notes": "",
      "decomposition_rationale": ""
    },
    {
      "node_id": "heart_rate_computation",
      "parent_id": "ECGProcessor_root",
      "name": "Heart Rate Computation",
      "description": "Compute instantaneous bpm from corrected R-R intervals with optional smoothing",
      "concept_type": "custom",
      "inputs": [
        {
          "name": "rpeaks",
          "type_desc": "np.ndarray",
          "constraints": "corrected R-peak sample indices"
        }
      ],
      "outputs": [
        {
          "name": "hr_idx",
          "type_desc": "np.ndarray",
          "constraints": "indices for heart-rate values"
        },
        {
          "name": "heart_rate",
          "type_desc": "np.ndarray",
          "constraints": "instantaneous heart rate in bpm"
        }
      ],
      "status": "atomic",
      "children": [],
      "depth": 1,
      "type_signature": "(rpeaks: np.ndarray, sampling_rate: float = 1000.0, smooth: bool = True) -> tuple[np.ndarray, np.ndarray]",
      "matched_primitive": null,
      "is_optional": false,
      "is_opaque": false,
      "critic_notes": "",
      "decomposition_rationale": ""
    }
  ],
  "edges": [
    {
      "source_id": "bandpass_filter",
      "target_id": "r_peak_detection",
      "output_name": "filtered",
      "input_name": "filtered",
      "source_type": "np.ndarray",
      "target_type": "np.ndarray",
      "requires_glue": false
    },
    {
      "source_id": "bandpass_filter",
      "target_id": "peak_correction",
      "output_name": "filtered",
      "input_name": "filtered",
      "source_type": "np.ndarray",
      "target_type": "np.ndarray",
      "requires_glue": false
    },
    {
      "source_id": "r_peak_detection",
      "target_id": "peak_correction",
      "output_name": "rpeaks",
      "input_name": "rpeaks",
      "source_type": "np.ndarray",
      "target_type": "np.ndarray",
      "requires_glue": false
    },
    {
      "source_id": "bandpass_filter",
      "target_id": "template_extraction",
      "output_name": "filtered",
      "input_name": "filtered",
      "source_type": "np.ndarray",
      "target_type": "np.ndarray",
      "requires_glue": false
    },
    {
      "source_id": "peak_correction",
      "target_id": "template_extraction",
      "output_name": "rpeaks_corrected",
      "input_name": "rpeaks",
      "source_type": "np.ndarray",
      "target_type": "np.ndarray",
      "requires_glue": false
    },
    {
      "source_id": "peak_correction",
      "target_id": "heart_rate_computation",
      "output_name": "rpeaks_corrected",
      "input_name": "rpeaks",
      "source_type": "np.ndarray",
      "target_type": "np.ndarray",
      "requires_glue": false
    }
  ],
  "metadata": {
    "source": "ingester",
    "class_name": "ECGProcessor"
  }
}
